%!PS-Adobe-3.0 EPSF-3.0
%%BoundingBox: 8 43 552 947
%%Title: C:\usr\local\teluhiko\GitHub\Color\testchart\testchartHS2.ps
%%Creator: GSview from C:\usr\local\teluhiko\GitHub\Color\testchart\testchartHS2.ps
%%CreationDate: Mon Apr 02 19:30:21 2018
%%Pages: 1
%%EndComments
%%Page: 1 1
%%BeginDocument: C:\usr\local\teluhiko\GitHub\Color\testchart\testchartHS2.ps
/HSL2RGB {
    100 div 3 1 roll
    100 div 3 1 roll
    360 div 3 1 roll
    hsl2rgb
%		3 {255 mul round 3 1 roll) repeat
} def
/hsl2rgb{
		/L exch def
		/S exch def
		/m2 L 0.5 le {L S 1 add mul}{L S add L S mul sub}ifelse def
		/m1 L 2 mul m2 sub def
    dup dup 1 3 div add hue2rgb 
    exch hue2rgb
    3 -1 roll 1 3 div sub hue2rgb
} def

/hue2rgb {
		dup 0 lt {1 add}if
		dup 1 gt {1 sub}if
		dup 6 mul 1 lt{
				m2 m1 sub mul 6 mul m1 add false
		}{true} ifelse
		{	dup 2 mul 1 lt
        {	pop m2 false}{true} ifelse
    }{false}ifelse
		{	dup 3 mul 2 lt
        {2 3 div exch sub m2 m1 sub mul 6 mul m1 add}
				{pop m1} ifelse
    }if
}def


/width  60 def
/height 45 def
/Top height def
/Left  10 def

%left top h s l Drawfig
/DrawFig{
		gsave
				HSL2RGB	setrgbcolor
				translate
        newpath
            0 0 moveto
				    width 0 lineto
				    width height lineto 0 height lineto
				closepath
				gsave
            fill
				grestore
        0 0 0 setrgbcolor
        stroke
		grestore
} def
%left top h l DrawPattern
/DrawPattern {
    /hue exch def
    /top exch def
    HList {
        /left left width add def
        left top hue 4 -1 roll
        exch
        light DrawFig
    } forall
} def

/Gray
[
%[   0   0  100]  
[   0  11   95]  %OK 95
[   0  15   90]  %OK 90
[   0  15   84]  %OK 85
[   0  17   77]  %OK 80
[   0  17   70]  %OK 75
[   0  17   64]  %OK 70
[  -5  15   59]  %OK 65
[   0  13   54]  %   60
[   0  10   50]  %   55
[   0  10   44]  %   50
[   0  10   41]  %   45
[   0  10   30]  %   40
[   0  10   25]  %   35
[   0  10   20]  %   30
[   0  10   15]  %   25
[   6  10   10]  %   20
%[   6  10    5]  
%[   0   0   0]
] def
Gray aload length {
    aload pop
    /light exch def
    /saturation exch def
    /hue exch def
    /left Left def

    [ -2 0 2] {
        saturation add 
        [ -5 0 5 ] {
            hue add exch dup 3 1 roll
            left Top 4 2 roll light DrawFig
            /left left width add def
        } forall
        pop
    } forall
    /Top Top height add def
} repeat

%%EndDocument
%%Trailer
